/*
    searchbar w/ custom search suggestions
    github.com/glenthemes/search-dropdown
*/
document.addEventListener("DOMContentLoaded",()=>{let e=parseInt(getComputedStyle(document.documentElement).getPropertyValue("--Search-Suggestions-Expand-Speed").trim()),t=document.querySelector(".searchblock"),s=document.querySelector(".searchbar-field"),n=document.querySelector(".search-suggestions-wrapper"),l=document.querySelector(".search-suggestions"),o=document.querySelectorAll(".search-suggestions a");if(t&&s&&n&&l&&o){if(!l.closest(".search-suggestions-inner")){let a=document.createElement("div");a.classList.add("search-suggestions-inner"),l.before(a),a.append(l)}let i=[],r=[];o.forEach(e=>{i.push(e.textContent),r.push(e.href)}),l.querySelectorAll("a").forEach((e,t)=>{t+=1,e.setAttribute("index",t)});let c="";s.addEventListener("keyup",e=>{[38,40,27].includes(e.keyCode)||""===s.value.trim()||(c=s.value)});let d=[];function v(){s.matches(".is-open")||(s.classList.add("opening"),n.classList.add("wrp-open"),setTimeout(()=>{s.classList.add("is-open"),s.classList.remove("opening")},e))}function u(){s.matches(".is-open:not(.opening)")&&(o.forEach(e=>{e.matches(".hov")&&e.classList.remove("hov")}),s.value=c,n.classList.remove("wrp-open"),setTimeout(()=>{l.classList.remove("z-entered"),l.classList.remove("disb-hov"),s.classList.remove("is-open")},e))}l.addEventListener("mousemove",()=>{let e=l.querySelectorAll("a.hov");if(e.length>1){e.forEach((e,t)=>{t+=1,d.length<2&&d.push(t)});let t=d[d.length-1];e.forEach((e,s)=>{(s+=1)==t&&e.classList.remove("hov")}),d=[]}}),o.forEach(e=>{e.addEventListener("mouseenter",()=>{let t=e.textContent;s.value=t,e.classList.add("hov"),e.addEventListener("mouseleave",()=>{s.value=c,e.classList.remove("hov")})})}),s.addEventListener("click",()=>{v()}),s.addEventListener("focus",()=>{v()}),document.addEventListener("click",e=>{e.target.closest(".search-suggestions, .searchbar-button button")||u.call(e.target,e)}),document.addEventListener("keydown",e=>{27==e.keyCode&&u()}),document.addEventListener("keydown",e=>{if(40==e.keyCode||38==e.keyCode){s!=document.activeElement||s.matches(".is-open")||v();let t=l.querySelector("a.hov");if(null==t)s.matches(".is-open")&&null==l.querySelector("a.hov")&&(40==e.keyCode?o[0].classList.add("hov"):38==e.keyCode&&o[o.length-1].classList.add("hov"));else{let n=t.getAttribute("index");o.forEach((t,l)=>{(l+=1)==n&&(40==e.keyCode?null!==t.nextElementSibling?(t.classList.remove("hov"),t.nextElementSibling.classList.add("hov"),s.value=t.nextElementSibling.textContent):l==o.length&&(o[0].classList.add("hov"),t.classList.remove("hov"),s.value=o[0].textContent):38==e.keyCode&&(null!==t.previousElementSibling?(t.classList.remove("hov"),t.previousElementSibling.classList.add("hov"),s.value=t.previousElementSibling.textContent):1==l&&(o[o.length-1].classList.add("hov"),t.classList.remove("hov"),s.value=o[o.length-1].textContent)))})}}}),t.addEventListener("submit",e=>{if(i.includes(s.value.trim())){let t=i.findIndex(e=>e.includes(s.value.trim()));e.preventDefault(),window.location.href=r[t]}})}});