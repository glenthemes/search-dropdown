/*
    searchbar w/ custom search suggestions
    github.com/glenthemes/search-dropdown
*/
document.addEventListener("DOMContentLoaded",()=>{let e=parseInt(getComputedStyle(document.documentElement).getPropertyValue("--Search-Suggestions-Expand-Speed").trim())||400;document.querySelectorAll(".searchblock")?.forEach(t=>{if(!t.matches(".initialized")){let s=t.querySelector(".searchbar-field"),o=t.querySelector(".search-suggestions-wrapper"),l=t.querySelector(".search-suggestions"),n=t.querySelectorAll(".search-suggestions a");if([s,o,l,n].every(e=>void 0===e))return;if(!l.closest(".search-suggestions-inner")){let i=document.createElement("div");i.classList.add("search-suggestions-inner"),l.before(i),i.append(l)}let r=[],a=[];n?.forEach((e,t)=>{r.push(e.textContent),a.push(e.href),e.setAttribute("index",t+1)});let c="";s.addEventListener("keyup",e=>{[38,40,27].includes(e.keyCode)&&["ArrowUp","ArrowDown","Escape"].includes(e.key)||""===s.value.trim()||(c=s.value)});let d=[];l.addEventListener("mousemove",()=>{let e=l.querySelectorAll("a.hov");if(e.length>1){e.forEach((e,t)=>{d.length<2&&d.push(t+1)});let t=d[d.length-1];e.forEach((e,s)=>{s+1==t&&e.classList.remove("hov")}),d=[]}}),n?.forEach(e=>{e.addEventListener("mouseenter",()=>{let t=e.textContent;s.value=t,e.classList.add("hov"),e.addEventListener("mouseleave",()=>{s.value=c,e.classList.remove("hov")})})});let v=["click","focus"];for(let h of v)s.addEventListener(h,()=>{u()});let u=()=>{s.matches(".is-open")||(s.classList.add("opening"),o.classList.add("wrp-open"),setTimeout(()=>{s.classList.add("is-open"),s.classList.remove("opening")},e))},m=["click","keydown"];for(let g of m)document.addEventListener(g,e=>{"click"==g?e.target.closest(".search-suggestions, .searchbar-button button")||p.call(e.target,e):"keydown"==g&&(27==e.keyCode||"Escape"==e.key)&&p()});let p=()=>{s.matches(".is-open:not(.opening)")&&(n.forEach(e=>{e.matches(".hov")&&e.classList.remove("hov")}),s.value=c,o.classList.remove("wrp-open"),setTimeout(()=>{l.classList.remove("z-entered"),l.classList.remove("disb-hov"),s.classList.remove("is-open")},e))};document.addEventListener("keydown",e=>{if(38==e.keyCode||"ArrowUp"==e.key||40==e.keyCode||"ArrowDown"==e.key){s!=document.activeElement||s.matches(".is-open")||u();let t=l.querySelector("a.hov");if(null==t)s.matches(".is-open")&&null==l.querySelector("a.hov")&&(40==e.keyCode||"ArrowDown"==e.key?n[0].classList.add("hov"):(38==e.keyCode||"ArrowUp"==e.key)&&n[n.length-1].classList.add("hov"));else{let o=t.getAttribute("index");n.forEach((t,l)=>{(l+=1)==o&&(40==e.keyCode||"ArrowDown"==e.key?null!==t.nextElementSibling?(t.classList.remove("hov"),t.nextElementSibling.classList.add("hov"),s.value=t.nextElementSibling.textContent):l==n.length&&(n[0].classList.add("hov"),t.classList.remove("hov"),s.value=n[0].textContent):(38==e.keyCode||"ArrowUp"==e.key)&&(null!==t.previousElementSibling?(t.classList.remove("hov"),t.previousElementSibling.classList.add("hov"),s.value=t.previousElementSibling.textContent):1==l&&(n[n.length-1].classList.add("hov"),t.classList.remove("hov"),s.value=n[n.length-1].textContent)))})}}}),t.addEventListener("submit",e=>{if(r.includes(s.value.trim())){let t=r.findIndex(e=>e.includes(s.value.trim()));e.preventDefault(),window.location.href=a[t]}}),t.classList.add("initialized")}})});