/*
    searchbar w/ custom search suggestions
    github.com/glenthemes/search-dropdown
*/
document.addEventListener("DOMContentLoaded",()=>{let e=Date.now(),t=3e3,s=parseInt(getComputedStyle(document.documentElement).getPropertyValue("--Search-Suggestions-Expand-Speed").trim()),n=document.querySelector(".searchblock"),l=document.querySelector(".searchbar-field"),i=document.querySelector(".searchbar-button button"),o=document.querySelector(".search-suggestions-wrapper"),a=document.querySelector(".search-suggestions"),r=document.querySelectorAll(".search-suggestions a");if(n&&l&&i&&o&&a&&r){n.querySelector("button[type='submit']");let d=[],c=[];r.forEach(e=>{d.push(e.textContent),c.push(e.href)}),a.querySelectorAll("a").forEach((e,t)=>{t+=1,e.setAttribute("index",t)});let v=setInterval(()=>{Date.now()-e>t?clearInterval(v):!a.matches(".expand")&&a.offsetHeight>0&&(clearInterval(v),a.style.setProperty("--Search-Suggestions-Height",a.offsetHeight+"px"))},0);function h(){!a.matches(".expand")&&a.offsetHeight>0&&a.style.setProperty("--Search-Suggestions-Height",a.offsetHeight+"px")}window.addEventListener("load",()=>{h()}),window.addEventListener("resize",()=>{h()});let u;"function"==typeof Event?u=new Event("resize"):(u=document.createEvent("Event")).initEvent("resize",!0,!0),window.dispatchEvent(u);let g="";l.addEventListener("keyup",e=>{[38,40,27].includes(e.keyCode)||""===l.value.trim()||(g=l.value)});let y=[];function m(){l.matches(".is-open")||(o.style.display="block",o.style.visibility="visible",o.classList.add("wrp-open"),a.style.height=0,setTimeout(()=>{a.classList.add("expand")},0),setTimeout(()=>{l.classList.add("is-open")},s))}function L(){l.matches(".is-open")&&(r.forEach(e=>{e.matches(".hov")&&e.classList.remove("hov")}),l.value=g,a.classList.remove("expand"),setTimeout(()=>{a.style.height=0,o.style.display="",o.style.visibility="",l.classList.remove("is-open"),a.classList.remove("z-entered"),a.classList.remove("disb-hov")},s))}a.addEventListener("mousemove",()=>{let e=a.querySelectorAll("a.hov");if(e.length>1){e.forEach((e,t)=>{t+=1,y.length<2&&y.push(t)});let t=y[y.length-1];e.forEach((e,s)=>{(s+=1)==t&&e.classList.remove("hov")}),y=[]}}),r.forEach(e=>{e.addEventListener("mouseenter",()=>{let t=e.textContent;l.value=t,e.classList.add("hov"),e.addEventListener("mouseleave",()=>{l.value=g,e.classList.remove("hov")})})}),l.addEventListener("click",()=>{m()}),l.addEventListener("focus",()=>{m()}),document.addEventListener("click",e=>{e.target.closest(".search-suggestions, .searchbar-button button")||L.call(e.target,e)}),document.addEventListener("keydown",e=>{27==e.keyCode&&L()}),document.addEventListener("keydown",e=>{if(40==e.keyCode||38==e.keyCode){l!=document.activeElement||l.matches(".is-open")||m();let t=a.querySelector("a.hov");if(null==t)l.matches(".is-open")&&null==a.querySelector("a.hov")&&(40==e.keyCode?r[0].classList.add("hov"):38==e.keyCode&&r[r.length-1].classList.add("hov"));else{let s=t.getAttribute("index");r.forEach((t,n)=>{(n+=1)==s&&(40==e.keyCode?null!==t.nextElementSibling?(t.classList.remove("hov"),t.nextElementSibling.classList.add("hov"),l.value=t.nextElementSibling.textContent):n==r.length&&(r[0].classList.add("hov"),t.classList.remove("hov"),l.value=r[0].textContent):38==e.keyCode&&(null!==t.previousElementSibling?(t.classList.remove("hov"),t.previousElementSibling.classList.add("hov"),l.value=t.previousElementSibling.textContent):1==n&&(r[r.length-1].classList.add("hov"),t.classList.remove("hov"),l.value=r[r.length-1].textContent)))})}}}),n.addEventListener("submit",e=>{if(d.includes(l.value.trim())){let t=d.findIndex(e=>e.includes(l.value.trim()));e.preventDefault(),window.location.href=c[t]}})}});